# TaskMaster AI Workspace Guidelines for Augment

## Project Overview
This is a TaskMaster AI project - an AI-driven task management system designed for ambitious development projects. TaskMaster helps break down complex requirements into manageable, well-structured tasks with dependencies, subtasks, and detailed implementation guidance.

## Core Technologies & Architecture
- **Runtime**: Node.js with ES modules
- **CLI Framework**: Commander.js for command-line interface
- **Interactive UI**: Inquirer.js with chalk for colored output and boxen for styled containers
- **AI Integration**: Multiple AI providers (Anthropic Claude, OpenAI, Google Gemini, Perplexity, xAI, OpenRouter)
- **Data Storage**: JSON files for task data (`tasks/tasks.json`)
- **Configuration**: `.taskmasterconfig` for AI models, `.env` for API keys
- **MCP Integration**: Model Context Protocol server for editor integrations (Cursor, Windsurf, VS Code)

## TaskMaster-Specific Patterns

### Task Structure
- Tasks have IDs, titles, descriptions, status, dependencies, and optional subtasks
- Subtasks use dot notation (e.g., task 5.2 is subtask 2 of task 5)
- Status values: pending, in-progress, done, review, blocked, deferred, cancelled
- Dependencies are arrays of task IDs that must be completed first

### Command Patterns
- All commands support both CLI and MCP interfaces
- Use `--append` flag when adding tasks to existing projects
- Commands that modify tasks should regenerate markdown files automatically
- AI-powered commands (parse-prd, update, expand) require API keys and can take time

### File Organization
- `tasks/tasks.json` - Main task data file
- `tasks/task_XXX.txt` - Individual task markdown files
- `scripts/` - PRD files and utilities
- `prd/` - PRD lifecycle tracking system
  - `prd/prds.json` - PRD metadata and tracking
  - `prd/pending/` - PRDs in pending status
  - `prd/in-progress/` - PRDs currently being worked on
  - `prd/done/` - Completed PRDs
  - `prd/archived/` - Archived PRDs
  - `prd/templates/` - PRD templates
- `.cursor/rules/` - Cursor AI integration rules
- `mcp-server/` - Model Context Protocol server
- `src/menu/` - Interactive menu system

## Development Guidelines

### Code Style
- Use ES modules (import/export) throughout
- Prefer async/await over promises
- Use descriptive variable names and clear function signatures
- Add JSDoc comments for complex functions
- Handle errors gracefully with try-catch blocks

### Interactive Menu System
- Use inquirer.js for user prompts with validation
- Implement breadcrumb navigation with sessionState.menuPath
- Provide colored output using chalk (blue for info, green for success, red for errors, yellow for warnings)
- Include "Back to Main Menu" options in sub-menus
- Show real-time project information in menu headers

### AI Integration Best Practices
- Always check for existing tasks before parsing PRD - offer append vs replace options
- Validate API keys before making AI calls
- Provide progress feedback for long-running AI operations
- Use research models for complex analysis when available
- Handle AI failures gracefully with fallback options

### Error Handling
- Log errors with context using the logging system
- Provide clear, actionable error messages to users
- Offer recovery options when operations fail
- Validate user input before processing

### Testing Approach
- Test CLI commands with various parameter combinations
- Verify interactive menu navigation and error handling
- Test AI integration with mock responses when possible
- Validate task data integrity after operations

## TaskMaster Command Reference

### Essential Commands
- `task-master init` - Initialize new project
- `task-master menu` - Launch interactive menu (recommended)
- `task-master parse-prd --input=<file>` - Generate tasks from PRD
- `task-master list` - Show all tasks
- `task-master next` - Find next available task
- `task-master set-status --id=<id> --status=<status>` - Update task status

### Task Management
- `task-master add-task --prompt="<description>"` - Add new task
- `task-master update-task --id=<id> --prompt="<context>"` - Update specific task
- `task-master expand --id=<id>` - Break task into subtasks
- `task-master remove-task --id=<id>` - Delete task

### Advanced Features
- `task-master analyze-complexity` - Analyze task complexity
- `task-master models --setup` - Configure AI models
- `task-master add-dependency --id=<id> --depends-on=<id>` - Add dependencies

### PRD Management Commands
- `task-master prd` - List all PRDs with filtering options
- `task-master prd-show <prd-id>` - Show detailed PRD information (e.g., prd_001, prd_002)
- `task-master prd-status <prd-id> <status>` - Update PRD status (e.g., prd_001 pending)
- `task-master prd-sync [prd-id]` - Sync PRD status with linked tasks (e.g., prd_001 or all)
- `task-master prd-organize` - Organize PRD files into status directories
- `task-master prd-check` - Check PRD integrity and consistency
- `task-master prd-migrate` - Migrate existing PRD files into tracking system
- `task-master prd-history <prd-id>` - Show PRD version history (e.g., prd_001)
- `task-master prd-track <prd-id>` - Track changes and create new version (e.g., prd_001)
- `task-master prd-compare <prd-id> <v1> <v2>` - Compare PRD versions (e.g., prd_001 1.0.0 1.1.0)

## PRD Lifecycle Management

### PRD Structure and Metadata
- PRDs are tracked in `prd/prds.json` with comprehensive metadata
- Each PRD has unique sequential ID (prd_001, prd_002, etc.), status, priority, complexity, and version history
- PRD files are automatically organized into status-based directories
- Bidirectional linking between PRDs and tasks maintains traceability
- Version control tracks all changes with timestamps and authors

### PRD Status Workflow
- **pending**: Initial state for new PRDs
- **in-progress**: Automatically set when first linked task starts
- **done**: Automatically set when ALL linked tasks are completed
- **archived**: Manual archiving of completed PRDs
- Status transitions are automated based on task completion

### PRD-Task Linking Best Practices
- Tasks generated from PRDs automatically include PRD source references
- Use `task-master prd-sync` to keep PRD status aligned with task progress
- PRD completion percentage is calculated from linked task statuses
- Orphaned links are detected and reported during integrity checks
- Manual linking/unlinking is supported for edge cases

### PRD Version Control
- File changes are automatically detected via hash comparison
- Version history includes snapshots of metadata and file state
- Compare versions to see what changed between iterations
- Track who made changes and when for audit trails
- Support for major, minor, and patch version increments

## Best Practices for TaskMaster Development

### When Working with Tasks
- Always use the interactive menu (`task-master menu`) for better UX
- Check task dependencies before marking tasks as done
- Use subtasks to break down complex implementations
- Update task status regularly to track progress
- Add dependencies to ensure proper execution order

### When Working with PRDs
- Use `task-master prd-migrate` to import existing PRD files
- Run `task-master prd-check` regularly to ensure data integrity
- Organize PRD files with `task-master prd-organize` for clean structure
- Track PRD changes with `task-master prd-track` after modifications
- Use PRD filtering options to find relevant documents quickly

### When Modifying TaskMaster Code
- Test changes with the interactive menu system
- Ensure both CLI and MCP interfaces work consistently
- Validate error handling with invalid inputs
- Update documentation when adding new features
- Consider backward compatibility with existing task files

### AI Model Configuration
- Set up multiple AI providers for redundancy
- Use research models for complex analysis tasks
- Configure fallback models for reliability
- Store API keys securely in `.env` file
- Test AI integration before deploying changes

## File Naming Conventions
- Use kebab-case for CLI command files
- Use camelCase for JavaScript functions and variables
- Use descriptive names for task files (task_001.txt, task_002.txt, etc.)
- Prefix utility functions with their purpose (validate-, format-, parse-)

## Integration Guidelines
- MCP tools should mirror CLI functionality
- Maintain consistency between interactive menu and direct commands
- Provide clear progress feedback for long-running operations
- Handle cross-platform differences (Windows vs Unix)
- Support both local and global installations

## Common Anti-Patterns to Avoid
- Don't manually edit `tasks.json` - use TaskMaster commands
- Don't manually edit `prd/prds.json` - use PRD management commands
- Don't skip dependency validation when adding tasks
- Don't ignore error handling in AI operations
- Don't hardcode file paths - use path resolution utilities
- Don't forget to regenerate task files after JSON changes
- Don't move PRD files manually - use `prd-organize` command
- Don't ignore PRD integrity warnings from `prd-check`

## When Implementing New Features
- Follow the existing command pattern (CLI + MCP + interactive menu)
- Add comprehensive error handling and validation
- Include progress feedback for user operations
- Update both documentation and help text
- Test with various project configurations
- Consider impact on existing task data structures
